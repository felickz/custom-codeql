# Use this configuration file when looking to get the broadest coverage of security results from the CodeQL Built in Suites, and the GitHub Security Lab Community Packs.
# A notable amount of false positives may be found in this configuration.  If you wish to reduce the number of false positives, use the default codeql suites :)

name: "Synthetic Apps All Queries"

# expand thread model - https://docs.github.com/en/code-security/code-scanning/creating-an-advanced-setup-for-code-scanning/customizing-your-advanced-setup-for-code-scanning#extending-codeql-coverage-with-threat-models
threat-models: local

# start from scratch - https://docs.github.com/en/code-security/code-scanning/creating-an-advanced-setup-for-code-scanning/customizing-your-advanced-setup-for-code-scanning#disabling-the-default-queries
disable-default-queries: true

packs:         
    # All queries from the CodeQL Built in packs
    - codeql/cpp-queries:.    
    - codeql/csharp-queries:.    
    - codeql/go-queries:.    
    - codeql/java-queries:.
    - codeql/javascript-queries:.
    - codeql/python-queries:.
    - codeql/ruby-queries:.
    - codeql/swift-queries:.

    # OSS queries from the GitHub Security Lab https://github.com/GitHubSecurityLab/CodeQL-Community-Packs
    - githubsecuritylab/codeql-cpp-queries
    - githubsecuritylab/codeql-csharp-queries
    - githubsecuritylab/codeql-go-queries
    - githubsecuritylab/codeql-java-queries
    - githubsecuritylab/codeql-javascript-queries    
    - githubsecuritylab/codeql-python-queries
    - githubsecuritylab/codeql-ruby-queries
        

    # Data extensions for libraries (library ext models are those generated by the corresponding queries in src) from the GitHub Security Lab https://github.com/GitHubSecurityLab/CodeQL-Community-Packs
    - githubsecuritylab/codeql-csharp-library-sources
    - githubsecuritylab/codeql-java-library-sources

    # Data extensions from the GitHub Security Lab https://github.com/GitHubSecurityLab/CodeQL-Community-Packs
    - githubsecuritylab/codeql-csharp-extensions
    - githubsecuritylab/codeql-java-extensions




query-filters:

# Start with Security Experimental https://github.com/github/codeql/blob/main/misc/suite-helpers/security-experimental-selectors.yml
# - precision ( low + Low or EXCLUDED precision)
# + problem.severity: recommendation
# - restriction of no experimental folder
- include:
    kind:
    - problem
    - path-problem
    precision:
    - high
    - very-high
    tags contain:
    - security
- include:
    kind:
    - problem
    - path-problem
    # REMOVE precision (Support NO or low/Low precision)
    # precision:
    # - medium  
    # - low
    # - Low
    problem.severity:
    - error
    - warning
    # ADD recommendation
    - recommendation
    tags contain:
    - security
- include:
    kind:
    - diagnostic
- include:
    kind:
    - metric
    tags contain:
    - summary
- exclude:
    deprecated: //
- exclude:
    query path:
      # REMOVE exclude - OK even if they exist in experimental folder
      #- /^experimental\/.*/
      - Metrics/Summaries/FrameworkCoverage.ql
      - /Diagnostics/Internal/.*/
- exclude:
    tags contain:
      - modeleditor
      - modelgenerator
